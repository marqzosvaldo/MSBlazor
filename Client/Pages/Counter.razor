@page "/counter"
@page "/counter/{CurrentCount:int}"


@inject IJSRuntime JSRuntime

<h1>Counter</h1>

<p>
  Current count:
  <span>@CurrentCount</span>
</p>
<button class="btn btn-primary" @onclick="IncrementCount">
  Click me
</button>


@code{
    private int currentCount = 0;
    [Parameter]
    public int CurrentCount {
        get => currentCount;
        set {
            if (currentCount != value) {
                currentCount = value;
                JSRuntime.InvokeAsync<string>("blazorLocalStorage.set", nameof(CurrentCount), currentCount);
            }
        }
    }
    protected override async Task OnInitializedAsync() {
        try {
            int? c = await JSRuntime.InvokeAsync<int?>("blazorLocalStorage.get", nameof(CurrentCount));
            if(c.HasValue){
                currentCount = c.Value;
            }
        } catch (Exception ex) {

            System.Console.WriteLine(ex.Message);
        }
    }

    private void IncrementCount() => CurrentCount += 1;
}